#!/bin/bash

# Comprobar Homebrew
if ! command -v brew &> /dev/null; then
    echo "Homebrew no est치 instalado. Instal치ndolo..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

echo "=== Actualizando Homebrew ==="
brew update

echo "=== Instalando Zsh ==="
brew install zsh git curl

# Cambiar shell por defecto
ZSH_PATH="$(brew --prefix)/bin/zsh"
if ! fgrep -q "$ZSH_PATH" /etc/shells; then
    echo "A침adiendo Zsh a /etc/shells"
    echo "$ZSH_PATH" | sudo tee -a /etc/shells
fi

chsh -s "$ZSH_PATH"

# Instalar Oh My Zsh
echo "=== Instalando Oh My Zsh ==="
export RUNZSH=no
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

ZSH_CUSTOM="${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}"

echo "=== Instalando Powerlevel10k ==="
git clone --depth=1 https://github.com/romkatv/powerlevel10k.git \
"$ZSH_CUSTOM/themes/powerlevel10k"

# Cambiar tema
sed -i '' 's|^ZSH_THEME=.*|ZSH_THEME="powerlevel10k/powerlevel10k"|' "$HOME/.zshrc"

echo "=== Instalando plugins ==="
git clone https://github.com/zsh-users/zsh-autosuggestions \
"$ZSH_CUSTOM/plugins/zsh-autosuggestions"

git clone https://github.com/zsh-users/zsh-syntax-highlighting \
"$ZSH_CUSTOM/plugins/zsh-syntax-highlighting"

# Activar plugins
sed -i '' 's|^plugins=.*|plugins=(git zsh-autosuggestions zsh-syntax-highlighting)|' "$HOME/.zshrc"

echo "=== Instalaci칩n completada ==="
echo "Cierra y vuelve a abrir la terminal para aplicar los cambios."
